<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Event Check-In</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 400px; margin: auto; }
    .attendee { border: 1px solid #ccc; padding: 20px; margin-top: 20px; }
    label { font-weight: bold; }
  </style>
</head>
<body>
  <h2>Check-In Scanner</h2>
  <div id="result">Loading...</div>

  <script>
    // Read email parameter from URL
    function getEmailFromUrl() {
      const params = new URLSearchParams(window.location.search);
      return params.get('email');
    }

    const email = getEmailFromUrl();
    const resultDiv = document.getElementById('result');

    if (!email) {
      resultDiv.innerHTML = "<p style='color:red;'>No email provided in the URL.</p>";
    } else {

      // âœ… Your CORRECT CORS-enabled Apps Script URL
      const baseUrl = "https://script.googleusercontent.com/a/macros/aiesec.es/echo?user_content_key=AehSKLjhBXliEx8x-kHfqRJ9t6-VVP_fsfdZNgN2EZDeehB4aVrjIOrW85xTZyLVFMI9_rLNz_Vs9rfeZ8rSqitGN6knIiTsrAgxBJYj0NVJ-IUKf0FdA7pDRKB3JkSDXF-oEO-s3sUKWyPWqtcRP6yRX6DLaEWMfDxUh-o4oibxA73bvK_iw-5hRjXvntXNhA6I5ePSM9a2SzAGlAkoqEmdfjZCI5dBR6a54ff8grA-KDIwj3WCRXcnt61pUGoW0QOrvrU4Sw0kMSwlvq1imeMpFO2zZc3fWMs3uMn5ZPcwzGqEzIPcew78XhjNNuxsZIG7dEEqeolgk27D8FPgfA8&lib=M_hKaFc4Ht1c5obgELxsJ-HUv17GpTK04";

      // Append email parameter
      const scriptUrl = baseUrl + "&email=" + encodeURIComponent(email);

      // Fetch attendee info
      fetch(scriptUrl)
        .then(response => response.json())
        .then(data => {
          if (!data || Object.keys(data).length === 0) {
            resultDiv.innerHTML = "<p style='color:red;'>Attendee not found!</p>";
          } else {
            // Display info
            resultDiv.innerHTML = `
              <div class="attendee">
                <p><label>Nombre & Apellido:</label> ${data.nombre} ${data.apellido}</p>
                <p><label>Cargo:</label> ${data.cargo}</p>
                <p><label>Correo Electronico:</label> ${data.correo}</p>
                <p><label>Empresa:</label> ${data.empresa}</p>
              </div>`;
          }
        })
        .catch(err => {
          resultDiv.innerHTML = "<p style='color:red;'>Error fetching data. Make sure the Apps Script URL is accessible.</p>";
          console.error(err);
        });
    }
  </script>
</body>
</html>
